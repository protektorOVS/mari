// parallax
// options.parallax = [0, 1] - offset width*parallax
function ws_glass_parallax(F,E,U){function H(l){return Math.round(1E3*l)/1E3}function Z(l,y,g,d){var G=(parseInt(l.parent().css("z-index"))||0)+1;if(J){G=d.getContext("2d");G.drawImage(l.get(0),0,0,y.width,y.height);var u;a:if(l=d.width,y=d.height,isNaN(g)||1>g)u=void 0;else{g|=0;try{u=G.getImageData(0,0,l,y)}catch(H){console.log("error:unable to access image data: "+H);u=!1;break a}var b=u.data,n,I,a,e,f,S,h,k,m,B,C,D,p,q,r,v,w,x,A;n=g+g+1;var F=l-1,K=y-1,t=g+1,L=t*(t+1)/2,M=new Y,c=M;for(a=1;a<
n;a++)if(c=c.next=new Y,a==t)var E=c;c.next=M;c=a=null;S=f=0;var N=aa[g],O=ba[g];for(I=0;I<y;I++){p=q=r=h=k=m=0;B=t*(v=b[f]);C=t*(w=b[f+1]);D=t*(x=b[f+2]);h+=L*v;k+=L*w;m+=L*x;c=M;for(a=0;a<t;a++)c.r=v,c.g=w,c.b=x,c=c.next;for(a=1;a<t;a++)e=f+((F<a?F:a)<<2),h+=(c.r=v=b[e])*(A=t-a),k+=(c.g=w=b[e+1])*A,m+=(c.b=x=b[e+2])*A,p+=v,q+=w,r+=x,c=c.next;a=M;c=E;for(n=0;n<l;n++)b[f]=h*N>>O,b[f+1]=k*N>>O,b[f+2]=m*N>>O,h-=B,k-=C,m-=D,B-=a.r,C-=a.g,D-=a.b,e=S+((e=n+g+1)<F?e:F)<<2,p+=a.r=b[e],q+=a.g=b[e+1],r+=a.b=
b[e+2],h+=p,k+=q,m+=r,a=a.next,B+=v=c.r,C+=w=c.g,D+=x=c.b,p-=v,q-=w,r-=x,c=c.next,f+=4;S+=l}for(n=0;n<l;n++){q=r=p=k=m=h=0;f=n<<2;B=t*(v=b[f]);C=t*(w=b[f+1]);D=t*(x=b[f+2]);h+=L*v;k+=L*w;m+=L*x;c=M;for(a=0;a<t;a++)c.r=v,c.g=w,c.b=x,c=c.next;e=l;for(a=1;a<=g;a++)f=e+n<<2,h+=(c.r=v=b[f])*(A=t-a),k+=(c.g=w=b[f+1])*A,m+=(c.b=x=b[f+2])*A,p+=v,q+=w,r+=x,c=c.next,a<K&&(e+=l);f=n;a=M;c=E;for(I=0;I<y;I++)e=f<<2,b[e]=h*N>>O,b[e+1]=k*N>>O,b[e+2]=m*N>>O,h-=B,k-=C,m-=D,B-=a.r,C-=a.g,D-=a.b,e=n+((e=I+t)<K?e:K)*
l<<2,h+=p+=a.r=b[e],k+=q+=a.g=b[e+1],m+=r+=a.b=b[e+2],a=a.next,B+=v=c.r,C+=w=c.g,D+=x=c.b,p-=v,q-=w,r-=x,c=c.next,f+=l}G.putImageData(u,0,0);u=!0}return u?z(d):0}d=z("<div></div>").css({position:"absolute","z-index":G,left:0,top:0}).css(y).appendTo(d);u=(Math.sqrt(5)+1)/2;E=1-u/2;for(e=0;E*e<g;e++)b=Math.PI*u*e,K=E*e+1,y=K*Math.cos(b),b=K*Math.sin(b),z(document.createElement("img")).attr("src",l.attr("src")).css({opacity:1/(e/1.8+1),position:"absolute","z-index":G,left:Math.round(y)+"px",top:Math.round(b)+
"px",width:"100%",height:"100%"}).appendTo(d);return d}function Y(){this.a=this.b=this.g=this.r=0;this.next=null}var z=jQuery,ca=z(this),V=F.parallax||.25,Q=z("<div>").css({position:"absolute",display:"none",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}).addClass("ws_effect ws_glass_parallax").appendTo(U),J=!F.noCanvas&&!window.opera&&!!document.createElement("canvas").getContext;if(J)try{document.createElement("canvas").getContext("2d").getImageData(0,0,1,1)}catch(da){J=0}var A=z("<div>").css({position:"absolute",
left:0,top:0,overflow:"hidden",width:"100%",height:"100%",transform:"translate3d(0,0,0)",zIndex:1}).appendTo(Q),W=A.clone().appendTo(Q),R=A.clone().css({width:"20%"}).appendTo(Q),T,X=A.clone().appendTo(Q).css({zIndex:0});this.go=function(l,y,g){var d=z(E.get(y)),d={position:"absolute",width:d.width(),height:d.height(),marginTop:d.css("marginTop"),marginLeft:d.css("marginLeft")};g=g?1:-1;var G=z(E.get(y)).clone().css(d).appendTo(A),u=z(E.get(l)).clone().css(d).appendTo(W),P=z(E.get(l)).clone().css(d).appendTo(R);
-1==g?(R.css({left:"auto",right:0}),P.css({left:"auto",right:0})):(R.css({left:0,right:"auto"}),P.css({left:0,right:"auto"}));var b=1.3*(U.width()||F.width);U.height();var n;J&&(T||(T=z("<canvas>").css({position:"absolute",left:0,top:0}).attr({width:d.width,height:d.height}).appendTo(X)),T.css(d).attr({width:d.width,height:d.height}),n=Z(z(E.get(l)),d,10,T.get(0)));J&&n||(J=0);wowAnimate(function(d){d=z.easing.swing(d);var a=H(g*d*b),e=H(g*(-b+d*b-(1-d)*b*.2)),f=H(g*(1.4*-b+d*(1.4*b+b/1.3))),l=H(-g*
b*V*d),h=H(g*b*V*(1-d)),k=H(-g*b*(V+.2)*d);d=H(g*(.2*-b+d*b*.4));F.support.transform?(A.css("transform","translate3d("+a+"px,0,0)"),G.css("transform","translate3d("+l+"px,0,0)"),W.css("transform","translate3d("+e+"px,0,0)"),u.css("transform","translate3d("+h+"px,0,0)"),R.css("transform","translate3d("+f+"px,0,0)"),P.css("transform","scale(1.6) translate3d("+k+"px,0,0)"),X.css("transform","translate3d("+d+"px,0,0)")):(A.css("left",a),G.css("margin-left",l),W.css("left",e),u.css("margin-left",h),R.css("left",
f),P.css("margin-left",k),X.css("left",d))},0,1,F.duration,function(){Q.hide();G.remove();u.remove();P.remove();ca.trigger("effectEnd")})};var aa=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,
259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,
360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ba=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,
22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]};
